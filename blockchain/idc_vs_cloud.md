基础设施架构
==========

## 概述

服务基础架构可以构建在IDC机房或者云服务器基础上。

IDC机房管理比较复杂，形式上可以分为托管和自建2种。IDC托管由机房方提供硬件设施如场地，机柜，电源，空调，基础网络布线，防火墙等等，托管方仅需购买服务器，以及负责机柜内的布线及设备维护。自建机房更为复杂，需要提供以上机房方的所有设备，对于国内来说还需要有一些资质的要求，另外对于自建机房在做一些安全资质上成本会大量上浮。

云机房管理相对简单，有专门的管理人员对服务进行维护，通常云机房也符合安全的要求，在资质以及处理突发问题上会比较容易。

{{important(
 以下方案是建立在在线用户量在1w左右的情况
)}}

## 云机房

### ECS服务器

|规格| vCPU|内存|存储|台数
---|---|---|---|---
ecs存储型|16核|64G|1788G|6
ecs内存型|16核|64G|300G|12

### RDS服务器
|规格| vCPU|内存|存储|台数|类型
---|---|---|---|---|---
MySQL 5.7(独享)|8核|64G|1000G|1|主库
MySQL 5.7|8核|64G|1000G|2|从库

### Redis服务器

|规格|台数
---|---
4G主从|2

### 其他服务

- Nas文件存储服务(SSD)
- MQ消息队列服务
- OSS多文件存储服务
- LBS负载均衡服务
- 高防IP服务(有需要的时候使用)

{{note(

   - 以上设备粗略估计75w每年，由于云设备构建简单，可以逐步增加设备，弹性扩容。
   - 人员配备 2 人
)}}

## IDC机房

### 基础网络设备

- 多路网络接入(电信/联通/BGP), 带宽100M
- 防火墙*1
- F5负载*2
- 光纤交换机*2
- 场地租用
- 机柜 * 2
- 空调，共享显示设备等等

### 服务器

- 机笼 * 3
- 刀片服务器 * 36

### 存储服务器

- NetAPP * 2 (双控制器, 满配)

{{note(

   - 以上设备一次性采购大概300w, 分5年老化，大约固定成本60w/年（不含电费，带宽，场地，监控管理软件等费用）
   - 人员配备 6 人以上
)}}
